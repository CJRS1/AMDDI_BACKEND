// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model usuario {
  id                Int      @id @default(autoincrement())
  pwd_hash          String   @db.VarChar(100)
  email             String   @unique @db.VarChar(255)
  nombre            String   @db.VarChar(50)
  apeMat            String   @map("apellido_paterno") @db.VarChar(50)
  apePat            String   @map("apellido_materno") @db.VarChar(50)
  dni               String   @unique @db.VarChar(8)
  celular           String?  @unique @db.VarChar(18)
  departamento      String   @db.VarChar(50)
  carrera           String   @db.VarChar(30)
  rol               String   @default("usuario")
  verification_code String?  @db.VarChar(4)
  pdf_url           String?  @db.VarChar(255)
  monto_pagado      Float?   @default(0)
  monto_total       Float?   @default(0)
  createdAt         DateTime @default(now()) @map("created_at")

  asignacion       asignacion[]
  usuario_servicio usuario_servicio[]

  @@map("usuarios")
}

model asesor {
  id        Int      @id @default(autoincrement())
  pwd_hash  String   @db.VarChar(100)
  email     String   @unique @db.VarChar(255)
  nombre    String   @db.VarChar(50)
  apeMat    String   @map("apellido_materno") @db.VarChar(50)
  apePat    String   @map("apellido_paterno") @db.VarChar(50)
  dni       String   @unique @db.VarChar(8)
  rol       String   @default("asesor")
  createdAt DateTime @default(now()) @map("created_at")

  asignacion          asignacion[]
  asesor_especialidad asesor_especialidad[]

  @@map("asesores")
}

model especialidad {
  id                  Int    @id @default(autoincrement())
  nombre_especialidad String @unique @db.VarChar(100)

  asesor_especialidad asesor_especialidad[]

  @@map("especialidades")
}

model usuario_servicio {
  id          Int @id @default(autoincrement())
  id_usuario  Int
  id_servicio Int

  usuario  usuario  @relation(fields: [id_usuario], references: [id])
  servicio servicio @relation(fields: [id_servicio], references: [id])

  @@map("usuario_servicio")
}

model servicio {
  id         Int    @id @default(autoincrement())
  nombre_servicio   String @unique @db.VarChar(200)

  usuario_servicio usuario_servicio[]

  @@map("servicios")
}

model asignacion {
  id          Int @id @default(autoincrement())
  id_asesor   Int
  id_usuarios Int

  asesor  asesor  @relation(fields: [id_asesor], references: [id])
  usuario usuario @relation(fields: [id_usuarios], references: [id])

  @@map("asignaciones")
}

model admin {
  id        Int      @id @default(autoincrement())
  pwd_hash  String   @db.VarChar(100)
  email     String   @unique @db.VarChar(255)
  nombre    String   @db.VarChar(50)
  apePat    String   @map("apellido_paterno") @db.VarChar(50)
  apeMat    String   @map("apellido_materno") @db.VarChar(50)
  dni       String   @unique @db.VarChar(8)
  rol       String   @default("admin")
  createdAt DateTime @default(now()) @map("created_at")

  @@map("administradores")
}

model asesor_especialidad {
  id              Int @id @default(autoincrement())
  id_asesor       Int
  id_especialidad Int

  asesor       asesor       @relation(fields: [id_asesor], references: [id])
  especialidad especialidad @relation(fields: [id_especialidad], references: [id])

  @@map("asesor_especialidad")
}
