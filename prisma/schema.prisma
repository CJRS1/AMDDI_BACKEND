// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id                Int      @id @default(autoincrement())
  pwd_hash          String   @db.VarChar(100)
  email             String   @unique
  nombre            String   @db.VarChar(50)
  apeMat            String   @db.VarChar(50) @map("apellido_paterno")
  apePat            String   @db.VarChar(50) @map("apellido_materno")
  dni           String   @db.VarChar(8)
  departamento      String   @db.VarChar(50)
  carrera           String   @db.VarChar(30)
  rol               String   @default("usuario")
  verification_code String?   @db.VarChar(4)
  pdf_url           String?   @db.VarChar(255)
  service_id        Int?      @unique @map("servicio_id")
  monto_pagado      Float?    @default(0) 
  createdAt         DateTime @default(now()) @map("created_at")

  asignacion Asignacion[]
  servicio   Servicio[]

  @@map("usuarios")
}

model Asesor {
  id        Int      @id @default(autoincrement())
  pwd_hash  String   @db.VarChar(100)
  email     String   @unique
  nombre    String   @db.VarChar(50) 
  apeMat    String   @db.VarChar(50) @map("apellido_materno")
  apePat    String   @db.VarChar(50) @map("apellido_paterno")
  dni           String   @db.VarChar(8)
  rol       String   @default("asesor")
  createdAt DateTime @default(now()) @map("created_at")

  asignacion          Asignacion[]
  asesor_especialidad Asesor_Especialidad[]

  @@map("asesores")
}

model Especialidad {
  id     Int    @id @default(autoincrement())
  nombre String @db.VarChar(100)

  asesor_especialidad Asesor_Especialidad[]

  @@map("especialidades")
}

model Servicio {
  id          Int    @id @default(autoincrement())
  servicio    String @db.VarChar(200)
  monto_total Float

  usuario Usuario @relation(fields: [id], references: [service_id])

  @@map("servicios")
}

model Asignacion {
  id          Int @id @default(autoincrement())
  id_asesor   Int
  id_usuarios Int

  asesor  Asesor  @relation(fields: [id_asesor], references: [id])
  usuario Usuario @relation(fields: [id_usuarios], references: [id])

  @@map("asignaciones")
}

model Admin {
  id        Int      @id @default(autoincrement())
  pwd_hash  String   @db.VarChar(100)
  email     String   @unique
  nombre    String   @db.VarChar(50)
  apePat  String   @db.VarChar(50) @map("apellido_paterno")
  apeMat  String   @db.VarChar(50) @map("apellido_materno")
  dni           String   @db.VarChar(8)
  rol       String   @default("admin")
  createdAt DateTime @default(now()) @map("created_at")

  @@map("administradores")
}

model Asesor_Especialidad {
  id              Int @id @default(autoincrement())
  id_asesor       Int
  id_especialidad Int

  asesor       Asesor       @relation(fields: [id_asesor], references: [id])
  especialidad Especialidad @relation(fields: [id_especialidad], references: [id])
}
